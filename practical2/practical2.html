
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Programming Session 2 &#8212; Data Science for Chemists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'practical2/practical2';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Programming Session 3" href="../practical3/practical3.html" />
    <link rel="prev" title="Programming Session 1" href="../practical1/practical1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
  
    <p class="title logo__title">Data Science for Chemists</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    SummerSchool-DS4C
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../practical1/practical1.html">Programming Session 1</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Programming Session 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practical3/practical3.html">Programming Session 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practical4/practical4.html">Programming Session 4</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Additional Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../examples/README.html">Data Mining Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Examples.html">Complex Numbers, Mean, and Classification</a></li>


<li class="toctree-l1"><a class="reference internal" href="../examples/decisiontree.html">Decision Tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Examples-Visualization.html">Data Visualization - Geo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/interaction.html">Using ipywidgets for user interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/mlp.html">Multilayer Perceptron - Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/perceptron.html">Perceptron - Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/recommendation.html">Recommendation System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/rfc.html">Random Forest Tree - Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/svm.html">Support Vector Machines - Classification</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references.html">Tools and libraries</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/practical2/practical2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Programming Session 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals">Goals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#screenshots">Screenshots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1 ★</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2 ★</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-notes">Important Notes:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3 ★★</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4 ★★</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5 ★★★</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6 ★★★</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="programming-session-2">
<h1>Programming Session 2<a class="headerlink" href="#programming-session-2" title="Link to this heading">#</a></h1>
<section id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Parsing and working with CSV, TSV and JSON files</p></li>
<li><p>Querying external data sources</p></li>
<li><p>Data analyses</p></li>
</ul>
<section id="exercises">
<h3>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Parsing and reading CSV/TSV files</p></li>
<li><p>Parsing and reading JSON files</p></li>
<li><p>Querying external data sources (Query endpoints and API)</p></li>
<li><p>Performing classical data analyses</p></li>
</ol>
</section>
<section id="screenshots">
<h3>Screenshots<a class="headerlink" href="#screenshots" title="Link to this heading">#</a></h3>
<p>Screenshots have been provided so that you can check and compare whether the output you have is the same as what we want from the step (or exercise) in question.</p>
</section>
</section>
<section id="exercise-1">
<h2>Exercise 1 ★<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h2>
<p>We first install the necessary <a class="reference external" href="http://packages.In">packages.In</a> Jupyter notebooks, you can use the <code class="docutils literal notranslate"><span class="pre">!</span></code> command to run shell commands directly from a notebook cell. To install Python packages such as NumPy, pandas, you can use the following command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>numpy<span class="w"> </span>pandas<span class="w"> </span>matplotlib<span class="w"> </span>sparqlwrapper
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: numpy in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (2.0.0)
Requirement already satisfied: pandas in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (2.2.2)
Requirement already satisfied: matplotlib in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (3.9.1)
Requirement already satisfied: sparqlwrapper in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (2.0.0)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from pandas) (2024.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from pandas) (2024.1)
Requirement already satisfied: contourpy&gt;=1.0.1 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from matplotlib) (1.2.1)
Requirement already satisfied: cycler&gt;=0.10 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from matplotlib) (4.53.1)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from matplotlib) (1.4.5)
Requirement already satisfied: packaging&gt;=20.0 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from matplotlib) (24.1)
Requirement already satisfied: pillow&gt;=8 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from matplotlib) (10.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from matplotlib) (3.1.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: rdflib&gt;=6.1.1 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from sparqlwrapper) (7.0.0)
Requirement already satisfied: six&gt;=1.5 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.16.0)
Requirement already satisfied: isodate&lt;0.7.0,&gt;=0.6.0 in /opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages (from rdflib&gt;=6.1.1-&gt;sparqlwrapper) (0.6.1)
</pre></div>
</div>
</div>
</div>
<p>To import the NumPy, pandas libraries in a Jupyter notebook, you use the following Python import statements:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">import</span> <span class="nn">SPARQLWrapper</span> <span class="k">as</span> <span class="nn">sw</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">__version__</span> </code>attribute is a common way to access the version information of a Python package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sw</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0.0
2.2.2
3.9.1
2.0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2">
<h2>Exercise 2 ★<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h2>
<p>Most of the time, we work with CSV (comma-separated values) files for
data analysis. A CSV file consits of one or more lines and each line has
one or more values separated by commas. One can consider every line as a
row and every value in a row as a column value. The first row is
sometimes used to describe the column names.</p>
<p>Copy the file
<a class="reference internal" href="#../../data/pl.csv"><span class="xref myst">pl.csv</span></a> to
your current working directory (where you are running Jupyter: TP1) and
use the following code to parse the csv file. Note the column names and
datatypes (U100, i4), where U100 corresponds to 100-character unicode string and i4 corresponds to 32-bit signed integer.</p>
<p>Please check the complete list of dtypes <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.dtypes.html">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span>
    <span class="s2">&quot;../data/pl.csv&quot;</span><span class="p">,</span>  <span class="c1"># Change this value to the path of your CSV file</span>
    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">),</span> <span class="s2">&quot;formats&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;U100&quot;</span><span class="p">,</span> <span class="s2">&quot;i4&quot;</span><span class="p">)},</span>
    <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># skip the first row, since it&#39;s the header</span>
    <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>  <span class="c1"># the separator is comma since it is a CSV file</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">,</span>  <span class="c1"># UTF-8 encoding</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;ENIAC coding system&#39;, 1943) (&#39;ENIAC Short Code&#39;, 1946)
 (&#39;Von Neumann and Goldstine graphing system&#39;, 1946)
 (&#39;ARC Assembly&#39;, 1947) (&#39;Plankalkül&#39;, 1948) (&#39;CPC Coding scheme&#39;, 1948)
 (&#39;Curry notation system&#39;, 1948) (&#39;Short Code&#39;, 1949)
 (&#39;assembly language&#39;, 1949) (&#39;Short Code&#39;, 1950) (&#39;G-code&#39;, 1950)
 (&#39;Birkbeck Assembler&#39;, 1950) (&#39;Superplan&#39;, 1951) (&#39;ALGAE&#39;, 1951)
 (&#39;Intermediate Programming Language&#39;, 1951)
 (&#39;Regional Assembly Language&#39;, 1951)
 (&#39;Boehm unnamed coding system&#39;, 1951) (&#39;Klammerausdrücke&#39;, 1951)
 (&#39;OMNIBAC Symbolic Assembler&#39;, 1951) (&#39;Stanislaus&#39;, 1951)
 (&#39;Whirlwind assembler&#39;, 1951) (&#39;Rochester assembler&#39;, 1951)
 (&#39;Sort Merge Generator&#39;, 1951) (&#39;autocode&#39;, 1952) (&#39;A-0 System&#39;, 1952)
 (&#39;Editing Generator&#39;, 1952) (&#39;COMPOOL&#39;, 1952) (&#39;Speedcoding&#39;, 1953)
 (&#39;READ/PRINT&#39;, 1953) (&#39;Fortran&#39;, 1954) (&#39;ARITH-MATIC&#39;, 1954)
 (&#39;autocode&#39;, 1954) (&#39;Laning and Zierler system&#39;, 1954)
 (&#39;MATH-MATIC&#39;, 1954) (&#39;MATRIX MATH&#39;, 1954) (&#39;FLOW-MATIC&#39;, 1955)
 (&#39;PACT&#39;, 1955) (&#39;BACAIC&#39;, 1955) (&#39;Freiburger Code&#39;, 1955)
 (&#39;Sequentielle Formelübersetzung&#39;, 1955) (&#39;Internal Translator&#39;, 1955)
 (&#39;PRINT&#39;, 1955) (&#39;Information Processing Language&#39;, 1956)
 (&#39;FORTRAN for the IBM 704&#39;, 1956) (&#39;Fortran&#39;, 1957) (&#39;COMTRAN&#39;, 1957)
 (&#39;GEORGE&#39;, 1957) (&#39;UNICODE&#39;, 1957) (&#39;ALGOL 58&#39;, 1958) (&#39;Lisp&#39;, 1958)
 (&#39;ALGOL&#39;, 1958) (&#39;FORTRAN III&#39;, 1958) (&#39;FORTRAN II&#39;, 1958)
 (&#39;JOVIAL&#39;, 1959) (&#39;TRAC&#39;, 1959) (&#39;COBOL&#39;, 1959) (&#39;MAD&#39;, 1959)
 (&#39;Lisp&#39;, 1959) (&#39;FACT&#39;, 1959) (&#39;COBOL&#39;, 1960) (&#39;ALCOR&#39;, 1960)
 (&#39;ALGOL 60&#39;, 1960) (&#39;FORTRAN IV&#39;, 1961) (&#39;TECO&#39;, 1962) (&#39;SNOBOL&#39;, 1962)
 (&#39;APL&#39;, 1962) (&#39;Simula&#39;, 1962) (&#39;CORC&#39;, 1962) (&#39;CPL&#39;, 1963)
 (&#39;JOSS&#39;, 1963) (&#39;P′′&#39;, 1964) (&#39;Report Program Generator&#39;, 1964)
 (&#39;TRAC&#39;, 1964) (&#39;BASIC&#39;, 1964) (&#39;COWSEL&#39;, 1964) (&#39;MARK IV&#39;, 1964)
 (&#39;MIMIC&#39;, 1964) (&#39;PL/I&#39;, 1964) (&#39;Speakeasy&#39;, 1964) (&#39;IBM RPG II&#39;, 1965)
 (&#39;Atlas Autocode&#39;, 1965) (&#39;TELCOMP&#39;, 1965) (&#39;Euler&#39;, 1966)
 (&#39;ISWIM&#39;, 1966) (&#39;ALGOL W&#39;, 1966)
 (&#39;Massachusetts General Hospital Utility Multi-Programming System&#39;, 1966)
 (&#39;JOSS&#39;, 1966) (&#39;Coral 66&#39;, 1966) (&#39;BCPL&#39;, 1966) (&#39;APL&#39;, 1966)
 (&#39;FORTRAN 66&#39;, 1966)
 (&#39;Massachusetts General Hospital Utility Multi-Programming System&#39;, 1967)
 (&#39;Hop&#39;, 1967) (&#39;XPL&#39;, 1967) (&#39;Interlisp&#39;, 1967) (&#39;BCPL&#39;, 1967)
 (&#39;Simula&#39;, 1967) (&#39;Space Programming Language&#39;, 1967) (&#39;PILOT&#39;, 1968)
 (&#39;ALGOL 68&#39;, 1968)]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">np.loadtxt</span></code></strong>: This function loads data from a text file, with each row in the text file being converted to a NumPy array element.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&quot;../data/pl.csv&quot;</span></code></strong>: The path to the CSV file. You need to change this to the actual path where your CSV file is located.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">dtype={&quot;names&quot;:</span> <span class="pre">(&quot;name&quot;,</span> <span class="pre">&quot;year&quot;),</span> <span class="pre">&quot;formats&quot;:</span> <span class="pre">(&quot;U100&quot;,</span> <span class="pre">&quot;i4&quot;)}</span></code></strong>: Specifies the data type for the resulting NumPy array. Here, <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is defined as a dictionary with:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code>: A tuple specifying the names of the columns.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">formats</span></code>: A tuple specifying the data type of each column. <code class="docutils literal notranslate"><span class="pre">&quot;U100&quot;</span></code> stands for a Unicode string of maximum length 100, and <code class="docutils literal notranslate"><span class="pre">&quot;i4&quot;</span></code> stands for a 4-byte integer.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">skiprows=1</span></code></strong>: This parameter skips the first row of the CSV file, which is assumed to be the header.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">delimiter=&quot;,&quot;</span></code></strong>: Specifies the delimiter that separates the values in the CSV file. Here, it is a comma.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">encoding=&quot;UTF-8&quot;</span></code></strong>: Specifies the encoding of the file. UTF-8 is a common encoding for text files.</p></li>
</ul>
<section id="important-notes">
<h3>Important Notes:<a class="headerlink" href="#important-notes" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>File Path</strong>: Ensure the file path (<code class="docutils literal notranslate"><span class="pre">&quot;../data/pl.csv&quot;</span></code>) is correct relative to your Jupyter notebook or script. You might need to adjust it depending on where your CSV file is located.</p></li>
<li><p><strong>CSV File Structure</strong>: The CSV file should have a header row that matches the column names specified in the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> parameter, and the data should follow in subsequent rows.</p></li>
<li><p><strong>Column Data Types</strong>: Ensure that the data types (<code class="docutils literal notranslate"><span class="pre">&quot;U100&quot;</span></code> for strings and <code class="docutils literal notranslate"><span class="pre">&quot;i4&quot;</span></code> for integers) match the actual data in your CSV file.</p></li>
</ol>
<p><img alt="" src="practical2/images/numpycsv.png" /></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html">CSV support in
numpy</a>
(<strong>Ref:</strong>
(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html">https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html</a>))
is different from Python’s default <a class="reference external" href="https://docs.python.org/3.9/library/csv.html">CSV
reader</a> (<strong>Ref:</strong>
(<a class="reference external" href="https://docs.python.org/3.9/library/csv.html">https://docs.python.org/3.9/library/csv.html</a>))
because of its capability to support the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html">data
types</a>
(<strong>Ref:</strong>
(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html">https://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html</a>)).
Before continuing, take a deep look at
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html">numpy.loadtxt</a>
(<strong>Ref:</strong>
(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html">https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html</a>)).</p>
<p>Copy the file
<a class="reference internal" href="#../../data/pl.tsv"><span class="xref myst">pl.tsv</span></a> to
your current working directory and use the following code to parse the
tsv file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span>
    <span class="s2">&quot;../data/pl.tsv&quot;</span><span class="p">,</span>  <span class="c1"># Change this value to the path of your CSV file</span>
    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">),</span> <span class="s2">&quot;formats&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;U100&quot;</span><span class="p">,</span> <span class="s2">&quot;i4&quot;</span><span class="p">)},</span>
    <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;ENIAC coding system&#39;, 1943) (&#39;ENIAC Short Code&#39;, 1946)
 (&#39;Von Neumann and Goldstine graphing system&#39;, 1946)
 (&#39;ARC Assembly&#39;, 1947) (&#39;Plankalkül&#39;, 1948) (&#39;CPC Coding scheme&#39;, 1948)
 (&#39;Curry notation system&#39;, 1948) (&#39;Short Code&#39;, 1949)
 (&#39;assembly language&#39;, 1949) (&#39;Short Code&#39;, 1950)
 (&#39;Birkbeck Assembler&#39;, 1950) (&#39;G-code&#39;, 1950) (&#39;Superplan&#39;, 1951)
 (&#39;ALGAE&#39;, 1951) (&#39;Intermediate Programming Language&#39;, 1951)
 (&#39;Regional Assembly Language&#39;, 1951)
 (&#39;Boehm unnamed coding system&#39;, 1951) (&#39;Klammerausdrücke&#39;, 1951)
 (&#39;OMNIBAC Symbolic Assembler&#39;, 1951) (&#39;Stanislaus&#39;, 1951)
 (&#39;Whirlwind assembler&#39;, 1951) (&#39;Rochester assembler&#39;, 1951)
 (&#39;Sort Merge Generator&#39;, 1951) (&#39;Editing Generator&#39;, 1952)
 (&#39;COMPOOL&#39;, 1952) (&#39;autocode&#39;, 1952) (&#39;A-0 System&#39;, 1952)
 (&#39;READ/PRINT&#39;, 1953) (&#39;Speedcoding&#39;, 1953) (&#39;Fortran&#39;, 1954)
 (&#39;MATRIX MATH&#39;, 1954) (&#39;autocode&#39;, 1954) (&#39;ARITH-MATIC&#39;, 1954)
 (&#39;Laning and Zierler system&#39;, 1954) (&#39;MATH-MATIC&#39;, 1954)
 (&#39;FLOW-MATIC&#39;, 1955) (&#39;BACAIC&#39;, 1955) (&#39;Freiburger Code&#39;, 1955)
 (&#39;Sequentielle Formelübersetzung&#39;, 1955) (&#39;Internal Translator&#39;, 1955)
 (&#39;PRINT&#39;, 1955) (&#39;PACT&#39;, 1955) (&#39;Information Processing Language&#39;, 1956)
 (&#39;FORTRAN for the IBM 704&#39;, 1956) (&#39;Fortran&#39;, 1957) (&#39;UNICODE&#39;, 1957)
 (&#39;COMTRAN&#39;, 1957) (&#39;GEORGE&#39;, 1957) (&#39;ALGOL 58&#39;, 1958) (&#39;Lisp&#39;, 1958)
 (&#39;FORTRAN III&#39;, 1958) (&#39;FORTRAN II&#39;, 1958) (&#39;ALGOL&#39;, 1958)
 (&#39;JOVIAL&#39;, 1959) (&#39;TRAC&#39;, 1959) (&#39;COBOL&#39;, 1959) (&#39;Lisp&#39;, 1959)
 (&#39;MAD&#39;, 1959) (&#39;FACT&#39;, 1959) (&#39;COBOL&#39;, 1960) (&#39;COBOL&#39;, 1960)
 (&#39;ALGOL 60&#39;, 1960) (&#39;ALCOR&#39;, 1960) (&#39;FORTRAN IV&#39;, 1961) (&#39;SNOBOL&#39;, 1962)
 (&#39;TECO&#39;, 1962) (&#39;Simula&#39;, 1962) (&#39;APL&#39;, 1962) (&#39;CORC&#39;, 1962)
 (&#39;CPL&#39;, 1963) (&#39;JOSS&#39;, 1963) (&#39;P′′&#39;, 1964)
 (&#39;Report Program Generator&#39;, 1964) (&#39;TRAC&#39;, 1964) (&#39;BASIC&#39;, 1964)
 (&#39;COWSEL&#39;, 1964) (&#39;PL/I&#39;, 1964) (&#39;MARK IV&#39;, 1964) (&#39;MIMIC&#39;, 1964)
 (&#39;Speakeasy&#39;, 1964) (&#39;IBM RPG II&#39;, 1965) (&#39;Atlas Autocode&#39;, 1965)
 (&#39;TELCOMP&#39;, 1965) (&#39;Euler&#39;, 1966) (&#39;ISWIM&#39;, 1966) (&#39;ALGOL W&#39;, 1966)
 (&#39;JOSS&#39;, 1966)
 (&#39;Massachusetts General Hospital Utility Multi-Programming System&#39;, 1966)
 (&#39;BCPL&#39;, 1966) (&#39;Coral 66&#39;, 1966) (&#39;FORTRAN 66&#39;, 1966) (&#39;APL&#39;, 1966)
 (&#39;Hop&#39;, 1967)
 (&#39;Massachusetts General Hospital Utility Multi-Programming System&#39;, 1967)
 (&#39;Space Programming Language&#39;, 1967) (&#39;BCPL&#39;, 1967) (&#39;Interlisp&#39;, 1967)
 (&#39;Simula&#39;, 1967) (&#39;XPL&#39;, 1967) (&#39;PILOT&#39;, 1968)]
</pre></div>
</div>
</div>
</div>
<p>Note the changes in the above code compared to the previous one. A TSV
file is a tab-separated file, i.e., the column values are separated by a
tab ((\t)).</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">np.loadtxt</span></code></strong>: This function loads data from a text file, with each row in the text file being converted to a NumPy array element.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&quot;../data/pl.tsv&quot;</span></code></strong>: The path to the TSV file. You need to change this to the actual path where your TSV file is located.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">dtype={&quot;names&quot;:</span> <span class="pre">(&quot;name&quot;,</span> <span class="pre">&quot;year&quot;),</span> <span class="pre">&quot;formats&quot;:</span> <span class="pre">(&quot;U100&quot;,</span> <span class="pre">&quot;i4&quot;)}</span></code></strong>: Specifies the data type for the resulting NumPy array. Here, <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is defined as a dictionary with:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code>: A tuple specifying the names of the columns.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">formats</span></code>: A tuple specifying the data type of each column. <code class="docutils literal notranslate"><span class="pre">&quot;U100&quot;</span></code> stands for a Unicode string of maximum length 100, and <code class="docutils literal notranslate"><span class="pre">&quot;i4&quot;</span></code> stands for a 4-byte integer.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">skiprows=1</span></code></strong>: This parameter skips the first row of the TSV file, which is assumed to be the header.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">delimiter=&quot;\t&quot;</span></code></strong>: Specifies the delimiter that separates the values in the TSV file. Here, it is a tab character.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">encoding=&quot;UTF-8&quot;</span></code></strong>: Specifies the encoding of the file. UTF-8 is a common encoding for text files.</p></li>
</ul>
<p>For counting the number of rows in your dataset, you can use <code class="docutils literal notranslate"><span class="pre">len()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the number of elements in the dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
</div>
</div>
<p>You can also display the output of variables and methods in a notebook without <code class="docutils literal notranslate"><span class="pre">print()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-3">
<h2>Exercise 3 ★★<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h2>
<p>Most of the external data sources may provide their data in JSON format.
Our next exercise is to parse JSON files. Copy the file
<a class="reference internal" href="#../../data/pl.json"><span class="xref myst">pl.json</span></a> to
your current working directory and use the following code to parse the
JSON file. In this exercise, we use <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/">Pandas python
package</a> (<strong>Ref:</strong>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/">https://pandas.pydata.org/pandas-docs/stable/</a>)) to
parse the JSON file to obtain a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">Pandas DataFrame</a>
(<strong>Ref:</strong>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html</a>)).
Try using methods like
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.transpose.html#pandas.DataFrame.transpose">transpose</a>
(<strong>Ref:</strong>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.transpose.html#pandas.DataFrame.transpose">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.transpose.html#pandas.DataFrame.transpose</a>)),
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.count.html#pandas.DataFrame.count">count</a>
(<strong>Ref:</strong>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.count.html#pandas.DataFrame.count">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.count.html#pandas.DataFrame.count</a>))
etc.</p>
<p>Before continuing this exercise, please practice working with Pandas.
Take a look at <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/10min.html">10 minutes to pandas</a>
(<strong>Ref:</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/10min.html">https://pandas.pydata.org/pandas-docs/stable/getting_started/10min.html</a>)).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">json_normalize</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Load JSON data from a file</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../data/pl.json&quot;</span><span class="p">))</span>

<span class="c1"># Convert JSON data to a pandas DataFrame</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                languageLabel  year
0                         ENIAC coding system  1943
1                            ENIAC Short Code  1946
2   Von Neumann and Goldstine graphing system  1946
3                                ARC Assembly  1947
4                                  Plankalkül  1948
..                                        ...   ...
95                                       BCPL  1967
96                                  Interlisp  1967
97                                     Simula  1967
98                                        XPL  1967
99                                      PILOT  1968

[100 rows x 2 columns]
</pre></div>
</div>
</div>
</div>
<p>This code is using Python’s pandas library to work with JSON data.</p>
<p>*. <strong>Imports</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">pandas</span> <span class="pre">import</span> <span class="pre">json_normalize</span></code>: Imports the <code class="docutils literal notranslate"><span class="pre">json_normalize</span></code> function from the pandas library. This function is used to flatten JSON data into a DataFrame.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pandas</span> <span class="pre">as</span> <span class="pre">pd</span></code>: Imports the pandas library with the alias <code class="docutils literal notranslate"><span class="pre">pd</span></code>, which is a common convention.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">json</span></code>: Imports Python’s built-in <code class="docutils literal notranslate"><span class="pre">json</span></code> module for handling JSON data.</p></li>
</ul>
<p>*. <strong>Loading JSON Data</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">=</span> <span class="pre">json.load(open(&quot;../data/pl.json&quot;))</span></code>: Opens a JSON file located at <code class="docutils literal notranslate"><span class="pre">&quot;../data/pl.json&quot;</span></code> and loads its contents into the <code class="docutils literal notranslate"><span class="pre">data</span></code> variable. The <code class="docutils literal notranslate"><span class="pre">json.load()</span></code> function reads the JSON file and parses it into a Python dictionary.</p></li>
</ul>
<ul class="simple">
<li><p><strong>Normalizing JSON into a DataFrame</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">=</span> <span class="pre">json_normalize(data)</span></code>: Uses the <code class="docutils literal notranslate"><span class="pre">json_normalize()</span></code> function from pandas to convert the nested JSON data (<code class="docutils literal notranslate"><span class="pre">data</span></code>) into a flat table-like structure called a DataFrame. This step is particularly useful for analyzing structured JSON data where nested objects or arrays need to be represented in tabular form.</p></li>
</ul>
</li>
</ul>
<p>And the output without <code class="docutils literal notranslate"><span class="pre">print()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>languageLabel</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ENIAC coding system</td>
      <td>1943</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ENIAC Short Code</td>
      <td>1946</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Von Neumann and Goldstine graphing system</td>
      <td>1946</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ARC Assembly</td>
      <td>1947</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Plankalkül</td>
      <td>1948</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>BCPL</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Interlisp</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Simula</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>98</th>
      <td>XPL</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>99</th>
      <td>PILOT</td>
      <td>1968</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div></div>
</div>
<p>To display the values of the column <strong>year</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the &quot;year&quot; column from the dataframe</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1943
1     1946
2     1946
3     1947
4     1948
      ... 
95    1967
96    1967
97    1967
98    1967
99    1968
Name: year, Length: 100, dtype: object
</pre></div>
</div>
</div>
</div>
<p>To display the values of the column <strong>languageLabel</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the &quot;languageLabel&quot; column from the dataframe</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;languageLabel&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0                           ENIAC coding system
1                              ENIAC Short Code
2     Von Neumann and Goldstine graphing system
3                                  ARC Assembly
4                                    Plankalkül
                        ...                    
95                                         BCPL
96                                    Interlisp
97                                       Simula
98                                          XPL
99                                        PILOT
Name: languageLabel, Length: 100, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Getting some important information like count, min, max using the method <code class="docutils literal notranslate"><span class="pre">describe()</span></code>. By default, it focuses on numerical columns (containing numbers) and calculates statistics like mean, standard deviation, quartiles (like 25th and 75th percentile), minimum and maximum values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get some descriptive summary of the dataframe</span>
<span class="n">dataframe</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>languageLabel</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>88</td>
      <td>24</td>
    </tr>
    <tr>
      <th>top</th>
      <td>COBOL</td>
      <td>1951</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>3</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dataframe.describe()</span></code> method in pandas generates descriptive statistics that summarize the central tendency, dispersion, and shape of a dataset’s distribution. Here’s what each part typically includes:</p>
<ol class="arabic simple">
<li><p><strong>Count</strong>: Number of non-null observations (rows) in each column.</p></li>
<li><p><strong>Mean</strong>: Average value of each numerical column.</p></li>
<li><p><strong>Std (Standard Deviation)</strong>: Measures the dispersion or spread of the values in each numerical column.</p></li>
<li><p><strong>Min</strong>: The smallest value in each numerical column.</p></li>
<li><p><strong>25% (Percentile)</strong>: The value below which 25% of the observations fall (1st quartile).</p></li>
<li><p><strong>50% (Median)</strong>: The median or 50th percentile.</p></li>
<li><p><strong>75% (Percentile)</strong>: The value below which 75% of the observations fall (3rd quartile).</p></li>
<li><p><strong>Max</strong>: The largest value in each numerical column.</p></li>
</ol>
<p>When you call <code class="docutils literal notranslate"><span class="pre">describe()</span></code> on a pandas DataFrame (<code class="docutils literal notranslate"><span class="pre">dataframe</span></code> in this case), it analyzes only the numerical columns by default and provides the statistical summary for each of these columns. Non-numerical columns are ignored unless specifically included by using additional parameters.</p>
<p>This method is useful for quickly getting an overview of your dataset’s numeric values, identifying outliers, understanding the distribution of your data, and more.</p>
<p>To display the unique values of the column <strong>year</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the unique years from the &quot;year&quot; column</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;1943&#39;, &#39;1946&#39;, &#39;1947&#39;, &#39;1948&#39;, &#39;1949&#39;, &#39;1950&#39;, &#39;1951&#39;, &#39;1952&#39;,
       &#39;1953&#39;, &#39;1954&#39;, &#39;1955&#39;, &#39;1956&#39;, &#39;1957&#39;, &#39;1958&#39;, &#39;1959&#39;, &#39;1960&#39;,
       &#39;1961&#39;, &#39;1962&#39;, &#39;1963&#39;, &#39;1964&#39;, &#39;1965&#39;, &#39;1966&#39;, &#39;1967&#39;, &#39;1968&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Note that the order of unique values returned by .unique() is not guaranteed.</p>
<p>To display the unique values of the column <strong>languageLabel</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the unique languages from the &quot;languageLabel&quot; column</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;languageLabel&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;ENIAC coding system&#39;, &#39;ENIAC Short Code&#39;,
       &#39;Von Neumann and Goldstine graphing system&#39;, &#39;ARC Assembly&#39;,
       &#39;Plankalkül&#39;, &#39;CPC Coding scheme&#39;, &#39;Curry notation system&#39;,
       &#39;Short Code&#39;, &#39;assembly language&#39;, &#39;Birkbeck Assembler&#39;, &#39;G-code&#39;,
       &#39;Superplan&#39;, &#39;ALGAE&#39;, &#39;Intermediate Programming Language&#39;,
       &#39;Regional Assembly Language&#39;, &#39;Boehm unnamed coding system&#39;,
       &#39;Klammerausdrücke&#39;, &#39;OMNIBAC Symbolic Assembler&#39;, &#39;Stanislaus&#39;,
       &#39;Whirlwind assembler&#39;, &#39;Rochester assembler&#39;,
       &#39;Sort Merge Generator&#39;, &#39;Editing Generator&#39;, &#39;COMPOOL&#39;, &#39;autocode&#39;,
       &#39;A-0 System&#39;, &#39;READ/PRINT&#39;, &#39;Speedcoding&#39;, &#39;Fortran&#39;,
       &#39;MATRIX MATH&#39;, &#39;ARITH-MATIC&#39;, &#39;Laning and Zierler system&#39;,
       &#39;MATH-MATIC&#39;, &#39;FLOW-MATIC&#39;, &#39;BACAIC&#39;, &#39;Freiburger Code&#39;,
       &#39;Sequentielle Formelübersetzung&#39;, &#39;Internal Translator&#39;, &#39;PRINT&#39;,
       &#39;PACT&#39;, &#39;Information Processing Language&#39;,
       &#39;FORTRAN for the IBM 704&#39;, &#39;UNICODE&#39;, &#39;COMTRAN&#39;, &#39;GEORGE&#39;,
       &#39;ALGOL 58&#39;, &#39;Lisp&#39;, &#39;FORTRAN III&#39;, &#39;FORTRAN II&#39;, &#39;ALGOL&#39;, &#39;JOVIAL&#39;,
       &#39;TRAC&#39;, &#39;COBOL&#39;, &#39;MAD&#39;, &#39;FACT&#39;, &#39;ALGOL 60&#39;, &#39;ALCOR&#39;, &#39;FORTRAN IV&#39;,
       &#39;SNOBOL&#39;, &#39;TECO&#39;, &#39;Simula&#39;, &#39;APL&#39;, &#39;CORC&#39;, &#39;CPL&#39;, &#39;JOSS&#39;, &#39;P′′&#39;,
       &#39;Report Program Generator&#39;, &#39;BASIC&#39;, &#39;COWSEL&#39;, &#39;PL/I&#39;, &#39;MARK IV&#39;,
       &#39;MIMIC&#39;, &#39;Speakeasy&#39;, &#39;IBM RPG II&#39;, &#39;Atlas Autocode&#39;, &#39;TELCOMP&#39;,
       &#39;Euler&#39;, &#39;ISWIM&#39;, &#39;ALGOL W&#39;,
       &#39;Massachusetts General Hospital Utility Multi-Programming System&#39;,
       &#39;BCPL&#39;, &#39;Coral 66&#39;, &#39;FORTRAN 66&#39;, &#39;Hop&#39;,
       &#39;Space Programming Language&#39;, &#39;Interlisp&#39;, &#39;XPL&#39;, &#39;PILOT&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>To sort the values by one or more columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;year&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>languageLabel</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ENIAC coding system</td>
      <td>1943</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ENIAC Short Code</td>
      <td>1946</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Von Neumann and Goldstine graphing system</td>
      <td>1946</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ARC Assembly</td>
      <td>1947</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Plankalkül</td>
      <td>1948</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>98</th>
      <td>XPL</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Massachusetts General Hospital Utility Multi-P...</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Hop</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Space Programming Language</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>99</th>
      <td>PILOT</td>
      <td>1968</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.sort_values([&quot;year&quot;])</span></code> sorts the DataFrame by the values in the column named “year”. You can specify one or more columns to sort by. By default, sorting is done in ascending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;languageLabel&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>languageLabel</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ENIAC coding system</td>
      <td>1943</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ENIAC Short Code</td>
      <td>1946</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Von Neumann and Goldstine graphing system</td>
      <td>1946</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ARC Assembly</td>
      <td>1947</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CPC Coding scheme</td>
      <td>1948</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Massachusetts General Hospital Utility Multi-P...</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Simula</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Space Programming Language</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>98</th>
      <td>XPL</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>99</th>
      <td>PILOT</td>
      <td>1968</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;languageLabel&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>languageLabel</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26</th>
      <td>A-0 System</td>
      <td>1952</td>
    </tr>
    <tr>
      <th>62</th>
      <td>ALCOR</td>
      <td>1960</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ALGAE</td>
      <td>1951</td>
    </tr>
    <tr>
      <th>52</th>
      <td>ALGOL</td>
      <td>1958</td>
    </tr>
    <tr>
      <th>48</th>
      <td>ALGOL 58</td>
      <td>1958</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Whirlwind assembler</td>
      <td>1951</td>
    </tr>
    <tr>
      <th>98</th>
      <td>XPL</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>8</th>
      <td>assembly language</td>
      <td>1949</td>
    </tr>
    <tr>
      <th>31</th>
      <td>autocode</td>
      <td>1954</td>
    </tr>
    <tr>
      <th>25</th>
      <td>autocode</td>
      <td>1952</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div></div>
</div>
<p>To obtain the data types of the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the data types of each column in the dataframe</span>
<span class="n">dataframe</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>languageLabel    object
year             object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dataframe.dtypes</span></code> attribute in pandas returns the data types of each column in the DataFrame <code class="docutils literal notranslate"><span class="pre">dataframe</span></code>. It provides information about how pandas has interpreted the data from the JSON (or any other source) based on its initial reading and normalization process. Here’s what you’ll typically see:</p>
<ul class="simple">
<li><p><strong>Numeric Types</strong>: Integers (<code class="docutils literal notranslate"><span class="pre">int64</span></code>), Floating-point numbers (<code class="docutils literal notranslate"><span class="pre">float64</span></code>).</p></li>
<li><p><strong>Object Type</strong>: Typically strings (<code class="docutils literal notranslate"><span class="pre">object</span></code>), but can also include other Python objects.</p></li>
<li><p><strong>DateTime Types</strong>: If applicable, pandas will recognize and label date/time data appropriately (<code class="docutils literal notranslate"><span class="pre">datetime64</span></code>).</p></li>
<li><p><strong>Categorical Types</strong>: If pandas identifies a column with a small number of unique values, it may assign it a <code class="docutils literal notranslate"><span class="pre">category</span></code> dtype, which can optimize memory usage and speed up certain operations.</p></li>
</ul>
</section>
<section id="exercise-4">
<h2>Exercise 4 ★★<a class="headerlink" href="#exercise-4" title="Link to this heading">#</a></h2>
<p>In this exercise, we will take a look at how to download data from
external data sources using special query interfaces. Take for example,
above data was obtained from <a class="reference external" href="https://query.wikidata.org/">Wikidata query</a>:**
(<a class="reference external" href="https://query.wikidata.org/">https://query.wikidata.org/</a>)) interface.
See the screenshot given below.</p>
<p><img alt="" src="practical2/images/wikidataquery.png" /></p>
<p>Given below is the code to read data from an external data source. Use
this
<a class="reference external" href="https://query.wikidata.org/sparql?query=SELECT%20%3FlanguageLabel%20(YEAR(%3Finception)%20as%20%3Fyear)%0AWHERE%0A%7B%0A%20%20%23instances%20of%20programming%20language%0A%20%20%3Flanguage%20wdt%3AP31%20wd%3AQ9143%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20wdt%3AP571%20%3Finception%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20rdfs%3Alabel%20%3FlanguageLabel.%0A%20%20FILTER(lang(%3FlanguageLabel)%20%3D%20%22en%22)%0A%7D%0AORDER%20BY%20%3Fyear%0ALIMIT%20100&amp;amp;format=json">url</a>:
(<a class="reference external" href="https://query.wikidata.org/sparql?query=SELECT%20%3FlanguageLabel%20(YEAR(%3Finception)%20as%20%3Fyear">https://query.wikidata.org/sparql?query=SELECT %3FlanguageLabel (YEAR(%3Finception) as %3Fyear</a>)%0AWHERE%0A%7B%0A%20%20%23instances%20of%20programming%20language%0A%20%20%3Flanguage%20wdt%3AP31%20wd%3AQ9143%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20wdt%3AP571%20%3Finception%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20rdfs%3Alabel%20%3FlanguageLabel.%0A%20%20FILTER(lang(%3FlanguageLabel)%20%3D%20%22en%22)%0A%7D%0AORDER%20BY%20%3Fyear%0ALIMIT%20100&amp;format=json).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://query.wikidata.org/sparql?query=SELECT</span><span class="si">%20%</span><span class="s2">3FlanguageLabel%20(YEAR(</span><span class="si">%3F</span><span class="s2">inception)</span><span class="si">%20a</span><span class="s2">s</span><span class="si">%20%</span><span class="s2">3Fyear)%0AWHERE%0A%7B%0A</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%23i</span><span class="s2">nstances</span><span class="si">%20o</span><span class="s2">f%20programming</span><span class="si">%20la</span><span class="s2">nguage%0A</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%3F</span><span class="s2">language%20wdt%3AP31%20wd%3AQ9143%3B%0A</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20wdt%3AP571</span><span class="si">%20%</span><span class="s2">3Finception%3B%0A</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20</span><span class="si">%20%</span><span class="s2">20rdfs%3Alabel</span><span class="si">%20%</span><span class="s2">3FlanguageLabel.%0A</span><span class="si">%20%</span><span class="s2">20FILTER(lang(</span><span class="si">%3F</span><span class="s2">languageLabel)</span><span class="si">%20%</span><span class="s2">3D</span><span class="si">%20%</span><span class="s2">22en%22)%0A%7D%0AORDER%20BY</span><span class="si">%20%</span><span class="s2">3Fyear%0ALIMIT%20100&amp;format=json&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">responsedata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>

<span class="n">array</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">responsedata</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">][</span><span class="s2">&quot;bindings&quot;</span><span class="p">]:</span>
    <span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;languageLabel&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]])</span>

<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;languageLabel&quot;</span><span class="p">])</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;i4&quot;</span><span class="p">,</span> <span class="s2">&quot;languageLabel&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;U200&quot;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    year                              languageLabel
0   1942                                 Plankalkül
1   1943                        ENIAC coding system
2   1946                           ENIAC Short Code
3   1946  Von Neumann and Goldstine graphing system
4   1948                          CPC Coding scheme
..   ...                                        ...
95  1967                                      ABSYS
96  1967                 Space Programming Language
97  1968                                      Refal
98  1968                                      PILOT
99  1968                                     MAPPER

[100 rows x 2 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>languageLabel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1942</td>
      <td>Plankalkül</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1943</td>
      <td>ENIAC coding system</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1946</td>
      <td>ENIAC Short Code</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1946</td>
      <td>Von Neumann and Goldstine graphing system</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1948</td>
      <td>CPC Coding scheme</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1967</td>
      <td>ABSYS</td>
    </tr>
    <tr>
      <th>96</th>
      <td>1967</td>
      <td>Space Programming Language</td>
    </tr>
    <tr>
      <th>97</th>
      <td>1968</td>
      <td>Refal</td>
    </tr>
    <tr>
      <th>98</th>
      <td>1968</td>
      <td>PILOT</td>
    </tr>
    <tr>
      <th>99</th>
      <td>1968</td>
      <td>MAPPER</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get some descriptive summary of the dataframe</span>
<span class="n">dataframe</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1958.300000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.500194</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1942.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1952.750000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1959.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1964.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1968.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get some descriptive summary of the year column</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     100.000000
mean     1958.300000
std         6.500194
min      1942.000000
25%      1952.750000
50%      1959.000000
75%      1964.000000
max      1968.000000
Name: year, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get some descriptive summary of the languageLabel column</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;languageLabel&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count          100
unique          99
top       autocode
freq             2
Name: languageLabel, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the data types of each column in the dataframe</span>
<span class="n">dataframe</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year              int32
languageLabel    object
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-5">
<h2>Exercise 5 ★★★<a class="headerlink" href="#exercise-5" title="Link to this heading">#</a></h2>
<p>This exercise will use some basic data analyses. Continuing with
the code in Exercise 4, le’s count the number of programming
languages released in a year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">grouped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>languageLabel</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1942</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1943</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1946</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1948</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1949</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>3</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>11</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1955</th>
      <td>8</td>
    </tr>
    <tr>
      <th>1956</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>6</td>
    </tr>
    <tr>
      <th>1958</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1959</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1960</th>
      <td>7</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>5</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>3</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>11</td>
    </tr>
    <tr>
      <th>1965</th>
      <td>5</td>
    </tr>
    <tr>
      <th>1966</th>
      <td>7</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>6</td>
    </tr>
    <tr>
      <th>1968</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The above code creates a new DataFrame <code class="docutils literal notranslate"><span class="pre">grouped</span></code> by grouping the original DataFrame <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> based on the values in the column named “year”, and then counting the occurrences in each group.</p>
<p>You can also use multiple aggregate functions using agg()</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;count&quot;</span><span class="p">])</span>
<span class="n">grouped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>languageLabel</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1942</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1943</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1946</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1948</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1949</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>3</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>11</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1955</th>
      <td>8</td>
    </tr>
    <tr>
      <th>1956</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>6</td>
    </tr>
    <tr>
      <th>1958</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1959</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1960</th>
      <td>7</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>5</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>3</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>11</td>
    </tr>
    <tr>
      <th>1965</th>
      <td>5</td>
    </tr>
    <tr>
      <th>1966</th>
      <td>7</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>6</td>
    </tr>
    <tr>
      <th>1968</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Till now, we worked with tables having two columns. Now we focus on
tables with three columns (programming language, year, paradigm). Copy
the file
<a class="reference internal" href="#../../data/plparadigm.json"><span class="xref myst">plparadigm.json</span></a>
to your working directory. And test the following program.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">json_normalize</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Load JSON data from a file</span>
<span class="n">jsondata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../data/plparadigm.json&quot;</span><span class="p">))</span>

<span class="c1"># Create an empty list to store temporary data</span>
<span class="n">array</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through each item in the JSON data</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">jsondata</span><span class="p">:</span>
    <span class="c1"># Extract specific values from each item and append them to the list</span>
    <span class="c1"># Assuming &quot;year&quot;, &quot;languageLabel&quot;, and &quot;paradigmLabel&quot; are keys in the JSON data</span>
    <span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;languageLabel&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;paradigmLabel&quot;</span><span class="p">]])</span>

<span class="c1"># Create a pandas DataFrame from the list with named columns</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;languageLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;paradigmLabel&quot;</span><span class="p">])</span>

<span class="c1"># Set data types for the columns in the DataFrame</span>
<span class="c1"># This ensures efficient storage and avoids potential errors during operations</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;languageLabel&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;U200&quot;</span><span class="p">,</span> <span class="s2">&quot;paradigmLabel&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;U200&quot;</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Group the DataFrame by &quot;year&quot; and &quot;paradigmLabel&quot; columns</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;paradigmLabel&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;count&quot;</span><span class="p">])</span>
<span class="n">grouped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>languageLabel</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>year</th>
      <th>paradigmLabel</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1948</th>
      <th>procedural programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1949</th>
      <th>non-structured programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th>procedural programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1950</th>
      <th>procedural programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1953</th>
      <th>procedural programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">1970</th>
      <th>imperative programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th>procedural programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th>structured programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1971</th>
      <th>functional programming</th>
      <td>1</td>
    </tr>
    <tr>
      <th>knowledge representation and reasoning</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>73 rows × 1 columns</p>
</div></div></div>
</div>
<p>Now test the following program. Compare the difference in output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;paradigmLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;count&quot;</span><span class="p">])</span>
<span class="n">grouped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>languageLabel</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>paradigmLabel</th>
      <th>year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">array programming</th>
      <th>1954</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1957</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1966</th>
      <td>1</td>
    </tr>
    <tr>
      <th>assembly language</th>
      <th>1956</th>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">structured programming</th>
      <th>1957</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1958</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1966</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1970</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>73 rows × 1 columns</p>
</div></div></div>
</div>
<p>Your next goal is to run the following query to get the population
information of different countries (limited to 10000 rows). Run the
following query on <a class="reference external" href="https://query.wikidata.org">Wikidata query service</a>
and download the JSON file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT DISTINCT ?countryLabel (YEAR(?date) as ?year) ?population
WHERE {
 ?country wdt:P31 wd:Q6256; #Country 
   p:P1082 ?populationStatement;
  rdfs:label ?countryLabel. #Label
 ?populationStatement ps:P1082 ?population; #population
  pq:P585 ?date. #period in time
 FILTER(lang(?countryLabel)=&quot;en&quot;) #Label in English
}
ORDER by ?countryLabel ?year
LIMIT 10000
</pre></div>
</div>
<p>Now, compute and display the following information (using various
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/10min.html">operations available in pandas library</a>
(<strong>Ref:</strong>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/10min.html">https://pandas.pydata.org/pandas-docs/stable/10min.html</a>))):</p>
<ol class="arabic simple">
<li><p>The population of countries in alphabetical order of their names and
ascending order of year.</p></li>
<li><p>The latest available population of every country</p></li>
<li><p>The country with the lowest and highest population (considering the
latest population)</p></li>
</ol>
<p>Your next goal is to run the following query to get information related
to scientific articles published after 2010 (limited to 10000 rows). Run
the following query on <a class="reference external" href="https://query.wikidata.org">Wikidata query service</a> and download the JSON file.
It gives you the following information related to the scientific
article: title, main subject and publication year.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT ?title ?subjectLabel ?year
{
  ?article wdt:P31 wd:Q13442814; #scientific article
           wdt:P1476 ?title; #title of the article
           wdt:P921 ?subject; #main subject
           wdt:P577 ?date. #publication date
  ?subject rdfs:label ?subjectLabel.
  BIND(YEAR(?date) as ?year).
  #published after 2010
  FILTER(lang(?title)=&quot;en&quot; &amp;&amp;
     lang(?subjectLabel)=&quot;en&quot; &amp;&amp; ?year&gt;2010)
}
LIMIT 5000
</pre></div>
</div>
<p>Now, compute and display the following information (using various
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/10min.html">operations available in pandas
library</a>
(<strong>Ref:</strong>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/10min.html">https://pandas.pydata.org/pandas-docs/stable/10min.html</a>))):</p>
<ol class="arabic simple">
<li><p>The number of articles published on different subjects every year.</p></li>
<li><p>Top subject of interest to the scientific community every year(based
on the above query results).</p></li>
<li><p>Top 10 subjects of interest to the scientific community (based on
the above query results) since 2010.</p></li>
</ol>
<p><strong>Hint</strong>:Take a look at functions groupby, reset_index, head, tail, sort_values, count of Pandas</p>
<p><strong>Note</strong>: If you get time-out errors, please change the LIMIT to some lower values (1000, 2000, 5000).</p>
</section>
<section id="exercise-6">
<h2>Exercise 6 ★★★<a class="headerlink" href="#exercise-6" title="Link to this heading">#</a></h2>
<p>In our final exercise, we will query Wikidata and obtain the URLs of the images. Then we will download these images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">SPARQLWrapper</span> <span class="kn">import</span> <span class="n">SPARQLWrapper</span><span class="p">,</span> <span class="n">JSON</span>

<span class="n">endpoint_url</span> <span class="o">=</span> <span class="s2">&quot;https://query.wikidata.org/sparql&quot;</span>

<span class="c1"># Get cities</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SELECT DISTINCT ?bigcity ?bigcityLabel ?country ?countryLabel ?image {</span>
<span class="s2">  ?bigcity wdt:P31 wd:Q1549591;</span>
<span class="s2">               wdt:P17 ?country;</span>
<span class="s2">               wdt:P18 ?image.</span>
<span class="s2"> SERVICE wikibase:label { bd:serviceParam wikibase:language &quot;en&quot;. }</span>
<span class="s2">}</span>
<span class="s2">LIMIT 10&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="n">endpoint_url</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="n">user_agent</span> <span class="o">=</span> <span class="s2">&quot;WDQS-example Python/</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">sparql</span> <span class="o">=</span> <span class="n">SPARQLWrapper</span><span class="p">(</span><span class="n">endpoint_url</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="n">user_agent</span><span class="p">)</span>
    <span class="n">sparql</span><span class="o">.</span><span class="n">setQuery</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">sparql</span><span class="o">.</span><span class="n">setReturnFormat</span><span class="p">(</span><span class="n">JSON</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sparql</span><span class="o">.</span><span class="n">query</span><span class="p">()</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>


<span class="n">array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">endpoint_url</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">][</span><span class="s2">&quot;bindings&quot;</span><span class="p">]:</span>
    <span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;bigcityLabel&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">],</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;countryLabel&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">],</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="s2">&quot;image&quot;</span><span class="p">])</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;U200&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;U200&quot;</span><span class="p">,</span> <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;U200&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">dataframe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>country</th>
      <th>image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Solingen</td>
      <td>Germany</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Paderborn</td>
      <td>Germany</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cottbus</td>
      <td>Germany</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bissau</td>
      <td>Guinea-Bissau</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ouagadougou</td>
      <td>Burkina Faso</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Belgrade</td>
      <td>Serbia</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Neuss</td>
      <td>Germany</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Moers</td>
      <td>Germany</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Remscheid</td>
      <td>Germany</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Muscat</td>
      <td>Oman</td>
      <td>http://commons.wikimedia.org/wiki/Special:File...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We will now download these images</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="k">def</span> <span class="nf">download_image</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0&quot;</span><span class="p">}</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">),</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">image</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">decode_content</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">status_code</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">download_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    200
1    200
2    200
3    200
4    200
5    200
6    200
7    200
8    200
9    200
Name: image, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Modify the above code and download images related to any subject of your choice (cities, historical monuments, flowers, buildings, etc.)</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./practical2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../practical1/practical1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Programming Session 1</p>
      </div>
    </a>
    <a class="right-next"
       href="../practical3/practical3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Programming Session 3</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals">Goals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#screenshots">Screenshots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1 ★</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2 ★</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-notes">Important Notes:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3 ★★</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4 ★★</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5 ★★★</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6 ★★★</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By John Samuel
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>